<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Product</title>

         <!-- Boostrap -->
         <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <link rel="stylesheet" href="/css/admin/addproduct.css">

    <!----===== Boxicons CSS ===== -->
    <link href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet'>
    <style>
      .preview-item {
      display: inline-block;
      margin: 10px;
    }

    .preview-image {
      width: 100px;
      height: auto;
    }

    .delete-button {
      display: block;
      margin-top: 5px;
    }

    </style>
</head>
<body>

    <nav class="sidebar close">
        <header>
          <div class="image-text">
            <span class="image">
              <img src="#" alt="">
            </span>
    
            <div class="text logo-text">
              <span class="name">Admin</span>
              <span class="profession">Web developer</span>
            </div>
          </div>
    
          <i class='bx bx-chevron-right toggle'></i>
        </header>
    
        <div class="menu-bar">
          <div class="menu">
    
            <li class="search-box">
              <i class='bx bx-search icon'></i>
              <input type="text" placeholder="Search Ganes...">
            </li>
    
            <ul class="menu-links">
              <li class="nav-link">
                <a href="/admin/dashboard">
                  <i class='bx bx-home-alt icon'></i>
                  <span class="text nav-text">Dashboard</span>
                </a>
              </li>
    
              <li class="nav-link">
                <a href="/admin/user">
                  <i class='bx bx-user icon'></i>
                  <span class="text nav-text">User</span>
                </a>
              </li>
    
              <li class="nav-link">
                <a href="/admin/category">
                  <i class='bx bxs-category icon'></i>
                  <span class="text nav-text">Category</span>
                </a>
              </li>
    
              <li class="nav-link">
                <a href="/admin/product">
                  <i class='bx bx-pie-chart-alt icon'></i>
                  <span class="text nav-text">Product</span>
                </a>
              </li>
    
              <li class="nav-link">
                <a href="/admin/order">
                  <i class='bx bx-heart icon'></i>
                  <span class="text nav-text">Order</span>
                </a>
              </li>
    
              <li class="nav-link">
                <a href="/admin/banner">
                  <i class='bx bx-wallet icon'></i>
                  <span class="text nav-text">Banner</span>
                </a>
              </li>
    
            </ul>
          </div>
    
          <div class="bottom-content">
            <li class="">
              <form action="/admin/logout" method="post">
                  <button>
                    <i class='bx bx-log-out icon'></i>
                  <span class="text nav-text">Logout</span>
                </button>  
              </form>
    
            <li class="mode">
              <div class="sun-moon">
                <i class='bx bx-moon icon moon'></i>
                <i class='bx bx-sun icon sun'></i>
              </div>
              <span class="mode-text text">Dark mode</span>
    
              <div class="toggle-switch">
                <span class="switch"></span>
              </div>
            </li>
    
          </div>
        </div>
    
      </nav>
    
      <section class="home">
        <div class="text">Add Product</div>
        <% if(errorMessage){ %>
        <h2 style="text-align: center;" class="errorMessage"><%= errorMessage %></h2>
        <% } %>
        <div class="form-div">
            <form action="/admin/add-product" method="post" enctype="multipart/form-data">
            <div class="form-group">
              <label for="product_name">Name</label>
              <input type="text" class="form-control" id="product_name" placeholder="Enter Product Name" name="product_name" required>
            </div>
            <div class="form-group">
              <label for="product_price">Price</label>
              <input type="number" class="form-control" id="product_price" placeholder="Enter the price of product" name="product_price" required>
            </div>
            <div class="form-group">
              <label for="exampleFormControlSelect1">Select Category</label>
              <select class="form-control" id="exampleFormControlSelect1" name="product_category">
                <!-- <option class="placeholder" selected disabled>Select a category</option> -->
                <% categories.forEach((category)=> {%>
                <option><%=category.name %></option>
                <% }) %>
              </select>
            </div>
            <div class="form-group">
                <label for="product_image">Image</label>
                <input type="file" class="form-control" id="product_image" placeholder="Select The Files" name="product_image" accept=".jpg, .png, .jpeg" multiple >
            </div>
            <!-- IMAGE  PREVIEW BEGIN -->
            <div id="previewContainer">
              
            </div>
            <!-- IMAGE  PREVIEW END -->
            <div class="form-group">
                <label for="product_stock">Stock</label>
                <input type="number" class="form-control" id="product_stock" placeholder="Enter Stock" name="product_stock" required>
            </div>
            <div class="form-group">
              <label for="product_description">Description</label>
              <textarea class="form-control" id="product_description" rows="3" name="product_description" required></textarea>
            </div>
            <button class="btn btn-primary" type="submit">Submit form</button>
          </form>
        </div>

      </section>
      <script>
        setTimeout(()=>{document.querySelector(".errorMessage").innerHTML=""},8000)
        /* Script For Deleting the Selected Images BEGIN  */
        
        document.getElementById("product_image").addEventListener('change', function(event) {
        const files = event.target.files; // Get the selected files
        
        const previewContainer = document.getElementById('previewContainer');
        previewContainer.innerHTML = ''; // Clear previous previews
        
        // Loop through each selected file
        for (let i = 0; i < files.length; i++) {
          const file = files[i];
          const reader = new FileReader(); // Create a FileReader object
          
          reader.onload = function(e) {
            // Create preview elements
            const previewElement = document.createElement('div');
            previewElement.classList.add('preview-item');
            
            const imageElement = document.createElement('img');
            imageElement.classList.add('preview-image');
            imageElement.src = e.target.result;
            previewElement.appendChild(imageElement);
            
            const deleteButton = document.createElement('button');
            deleteButton.classList.add('delete-button');
            deleteButton.textContent = 'Delete';
            deleteButton.addEventListener('click', function() {
              previewContainer.removeChild(previewElement); // Remove preview when delete button is clicked
              // Remove the corresponding file from the input's selection
              const fileInput = document.getElementById('product_image');
              const newFiles = Array.from(fileInput.files).filter(f => f !== file); // Filter out the deleted file
              fileInput.value = ''; // Clear the input value
              const newFileList = new DataTransfer(); // Create a new DataTransfer object
              newFiles.forEach(f => newFileList.items.add(f)); // Add the remaining files to the new DataTransfer object
              fileInput.files = newFileList.files; // Assign the new DataTransfer object back to the file input
            });
            previewElement.appendChild(deleteButton);
            
            // Append preview to container
            previewContainer.appendChild(previewElement);
          };
          
          // Read the selected file as a data URL
          reader.readAsDataURL(file);
        }

        /* Script For Deleting the Selected Images END  */
});


      </script>

      <script>
        const body = document.querySelector('body'),
          sidebar = body.querySelector('nav'),
          toggle = body.querySelector(".toggle"),
          searchBtn = body.querySelector(".search-box"),
          modeSwitch = body.querySelector(".toggle-switch"),
          modeText = body.querySelector(".mode-text");
        toggle.addEventListener("click", () => {
          sidebar.classList.toggle("close");
        })
        searchBtn.addEventListener("click", () => {
          sidebar.classList.remove("close");
        })
        modeSwitch.addEventListener("click", () => {
          body.classList.toggle("dark");
          if (body.classList.contains("dark")) {
            modeText.innerText = "Light mode";
          } else {
            modeText.innerText = "Dark mode";
          }
        });
      </script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    
</body>
</html>